# 项目完整运行流程计划

## 1. 启动ComfyUI服务

### 1.1 查找ComfyUI安装位置

* 检查常见安装目录：

  * `C:\ComfyUI`

  * `D:\ComfyUI`

  * `%USERPROFILE%\ComfyUI`

  * `%USERPROFILE%\Downloads\ComfyUI`

### 1.2 启动ComfyUI

* **Windows**: 运行 `run_nvidia_gpu.bat` 或 `run_cpu.bat`

* **命令行**: `python main.py`

* **后台运行**: 使用 `python main.py --listen` 允许外部访问

### 1.3 验证ComfyUI启动

* 等待服务启动（通常需要30秒-1分钟）

* 访问 <http://127.0.0.1:8188> 确认服务运行

* 使用 `check_comfyui.py` 脚本验证API响应：

  ```bash
  python check_comfyui.py
  ```

  预期输出：`✅ ComfyUI服务正常响应`

## 2. 运行项目流程

### 2.1 确保虚拟环境已激活

* **PowerShell**: `.\venv\Scripts\Activate.ps1`

* **Command Prompt**: `.\venv\Scripts\activate.bat`

### 2.2 启动后端服务（可选）

如果需要使用API服务，可启动后端：

```bash
cd backend
python run.py
```

后端服务将在 <http://0.0.0.0:5000> 启动

### 2.3 运行视频生成脚本

这是项目的核心功能，生成视频：

```bash
cd ..
python generate_video.py
```

## 3. 监控生成过程

### 3.1 查看控制台输出

* 监控各阶段进度

* 检查是否有错误信息

* 查看生成参数和状态

### 3.2 查看ComfyUI界面

* 访问 <http://127.0.0.1:8188>

* 查看图像生成状态

* 监控GPU使用情况

### 3.3 查看日志文件

* 日志文件位置：`logs/video_generation_*.log`

* 查看详细的生成过程

* 排查可能的错误

## 4. 结果检查

### 4.1 检查生成的视频

* 视频输出位置：`output/videos/`

* 验证视频质量和内容

* 检查视频分辨率（1920x1080）和帧率（30fps）

### 4.2 查看生成报告

* 检查日志文件中的统计信息

* 查看各阶段的执行时间

* 分析生成过程中的性能指标

## 5. 常见问题及解决方案

### 5.1 ComfyUI启动失败

* 检查显卡驱动和CUDA版本

* 检查Python环境和依赖

* 查看ComfyUI启动日志

### 5.2 视频生成超时

* 增加超时时间：修改`config.py`中的`AGENT_TIMEOUT`值

* 减少视频时长或分辨率

* 检查网络连接

### 5.3 模型加载失败

* 确认模型文件已正确放置在 `ComfyUI/models/checkpoints/` 目录

* 检查模型文件名是否与工作流配置中的名称一致

* 重新下载缺失的模型文件

## 6. 预期结果

* ✅ ComfyUI服务成功启动

* ✅ 视频生成流程执行完成

* ✅ 生成一个60秒的风景旅行视频

* ✅ 视频分辨率1920x1080（1080p高清）

* ✅ 视频帧率30fps

* ✅ 视频风格符合cinematic要求

## 7. 后续优化

* 添加背景音乐和字幕

* 优化视频转场效果

* 调整色彩和对比度

* 增加视频长度和复杂度

* 优化生成参数以提高质量或速度

